<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Ikarus - Ambulanz importieren</title>
    <link rel="stylesheet" href="css/bootstrap-4.3.1.min.css">
    <link rel="stylesheet" href="css/fontawesome-5.8.2.all.min.css">
    <script src="js/jquery-3.4.1.min.js"></script>
    <script src="js/bootstrap-4.3.1.min.js"></script>
    <script src="js/functions.js"></script>
    <script src="js/api-handling.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
    <h3 class="text-white">Ikarus&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h3>
    <ul class="navbar-nav mr-auto">
        <li class="nav-item">
            <a class="nav-link" href="index.html">Ambulanzen</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="edit-event.html">Ambulanz hinzuf&uuml;gen</a>
        </li>
        <li class="nav-item active">
            <a class="nav-link" href="import-event.html">Ambulanz importieren</a>
        </li>
        <li class="nav-item">
            <a id="event-edit" class="nav-link disabled">Ambulanz bearbeiten</a>
        </li>
    </ul>
    <button class="btn btn-info btn-sm" data-toggle="modal" data-target="#info" title="Info"><i class="far fa-question-circle fa-fw"></i></button>
</nav>
<div class="container py-2">
    <form class="was-validated">
        <div class="form-group">
            <h4>Ambulanz importieren</h4>
        </div>
        <div class="form-group">
            <label for="import-event-file">Ambulanz-Datei:&nbsp;</label>
            <input type="file" id="import-event-file" name="event-file" accept="text/calendar" required/>
            <div class="valid-feedback">OK</div>
            <div class="invalid-feedback">Bitte w√§hle eine Ambulanz-Kalenderdatei aus</div>
        </div>
    </form>
    <button id="import-event-submit" class="btn btn-primary" onclick="sendImportData();">Ambulanz importieren</button>
</div>
</body>
<script type="text/javascript">
    function sendImportData() {
        var eventData = new FormData();
        eventData.append("eventFile", $("#import-event-file")[0].files[0]);
        importEvent(eventData, function(result) {
            setCurrentEvent(result["id"]);
            window.location.href = "edit-event.html";
        }, function() {
            $(".container").append("<br/><br/><div id='error-alert' class='alert alert-danger alert-dismissible fade show'><button class='close' data-dismiss='alert'>&times;</button>Die Ambulanz konnte nicht importiert werden (ung&uuml;ltiges Format)!</div>");
            $("#error-alert").fadeTo(5000, 0.0, function() {
                $("#error-alert").remove();
            });
        });
    }
</script>
</html>